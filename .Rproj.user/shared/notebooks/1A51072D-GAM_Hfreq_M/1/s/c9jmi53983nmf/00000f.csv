"0","library(tidyverse)"
"0",""
"0","#load(""data/full_data.RData"")"
"0",""
"0","attributes(full_data$datetime_posix) # already in correct TZ"
"1","$tzone
"
"1","[1]"
"1"," ""Pacific/Port_Moresby"""
"1","
"
"1","
"
"1","$class
"
"1","[1]"
"1"," ""POSIXct"""
"1"," ""POSIXt"" "
"1","
"
"1","
"
"0","subdata <- full_data %>% "
"0","  filter(habitat == ""slope"") %>% "
"0","  filter(! location %in% c(""E_slope"", ""NW_slope"")) %>% "
"0","  #filter every fifth row"
"0","   filter(row_number() %% 5 == 1)  %>%"
"0","  #create day time factor"
"0","  mutate(hour = hour(datetime_posix),"
"0","         minutes = minute(datetime_posix), "
"0","         time = hour + minutes/60) %>% "
"0","  #select(-c(hour, minutes)) %>% "
"0","  mutate(daynight = ifelse(time > 5 & time < 17, ""day"", ""night""),"
"0","         daynight = factor(daynight)) %>% "
"0","  select(HM, location, habitat, datetime_posix, period, month, daynight, day, hour, time, "
"0","         high_freq_M, lunar_phase8, lunar_illum, temp, wd, ws) %>% "
"0","  mutate(lunar_phase8 = factor(lunar_phase8, levels=c(""New"", ""Waxing crescent"", ""First quarter"", ""Waxing gibbous"", ""Full"", ""Waning gibbous"", ""Last quarter"", ""Waning crescent""))) %>%"
"0","  mutate(lunar.n = as.numeric(lunar_phase8)) %>%  # model lunar phase as a conituous variable"
"0","  #Some extreme outlier maybe association with boat"
"0","  #Remove top quantiles for each group "
"0","  #SW_slope has a lot of outliers...."
"0","  group_by(location) %>% "
"0","  group_modify(~ if (.y$location == ""SW_slope"") filter(.x, between(high_freq_M, quantile(high_freq_M, 0), quantile(high_freq_M, .95))) else filter(.x, between(high_freq_M, quantile(high_freq_M, 0), quantile(high_freq_M, .975)))) %>%"
"0","  mutate(stemp = scale(temp), "
"0","         sws = scale(ws), "
"0","         nHFM = (high_freq_M-min(high_freq_M))/(max(high_freq_M)-min(high_freq_M)))"
"0",""
"0","subdata_hf <- subdata"
