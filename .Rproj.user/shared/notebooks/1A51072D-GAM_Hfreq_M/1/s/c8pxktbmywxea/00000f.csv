"0","sm <- smooth_estimates(my.gam) |>
  add_confint()

x <- subdata.full |>
  add_partial_residuals(my.gam)

names(x)
"
"1"," [1]"
"1"," ""location""            "
"1"," ""HM""                  "
"1"," ""habitat""             "
"1","
"
"1"," [4]"
"1"," ""datetime_posix""      "
"1"," ""period""              "
"1"," ""month""               "
"1","
"
"1"," [7]"
"1"," ""daynight""            "
"1"," ""day""                 "
"1"," ""hour""                "
"1","
"
"1","[10]"
"1"," ""time""                "
"1"," ""high_freq_M""         "
"1"," ""lunar_phase8""        "
"1","
"
"1","[13]"
"1"," ""lunar_illum""         "
"1"," ""temp""                "
"1"," ""wd""                  "
"1","
"
"1","[16]"
"1"," ""ws""                  "
"1"," ""lunar.n""             "
"1"," ""stemp""               "
"1","
"
"1","[19]"
"1"," ""sws""                 "
"1"," ""nHFM""                "
"1"," ""s(time)""             "
"1","
"
"1","[22]"
"1"," ""s(lunar.n)""          "
"1"," ""s(stemp)""            "
"1"," ""s(location,daynight)"""
"1","
"
"0","# Choose colours"
"0","library(RColorBrewer)"
"0","my_cols <- brewer.pal(n = 4, name = 'Dark2')"
"0","my_cols"
"1","[1]"
"1"," ""#1B9E77"""
"1"," ""#D95F02"""
"1"," ""#7570B3"""
"1"," ""#E7298A"""
"1","
"
"0","# set font size:"
"0","custom_theme <- theme("
"0","  axis.title = element_text(size = 5.5),"
"0","  axis.text = element_text(size = 5),)"
"0",""
"0","# plotting time"
"0","p_time_HFM <- "
"0","  sm |>"
"0","  filter(.smooth == ""s(time)"") |>"
"0","  ggplot() +"
"0","  geom_ribbon(aes(ymin = .lower_ci, ymax = .upper_ci, x = time),"
"0","    fill = my_cols[1], alpha = 0.2) +"
"0","  geom_line(aes(x = time, y = .estimate), colour = my_cols[1], lwd = 1) +  "
"0","      theme_bw() +"
"0","  labs(y = ""M in the high freq. band (normalised)"", x = ""Hour of the Day"")+"
"0","  scale_x_continuous(breaks = seq(0, 25, by = 2), expand = expansion(add=0))+"
"0","  scale_y_continuous(expand = expansion(add=0), limits = c(-2.1, 2.1))+"
"0","  custom_theme"
"0",""
"0","# plotting lunar"
"0","p_lunar_HFM <- sm |>"
"0","  filter(.smooth == ""s(lunar.n)"") |>"
"0","  ggplot() +"
"0","  geom_ribbon(aes(ymin = .lower_ci, ymax = .upper_ci, x = lunar.n),  "
"0","    fill= my_cols[3], alpha = 0.2) +"
"0","  geom_line(aes(x = lunar.n, y = .estimate), colour = my_cols[3], lwd = 1.) +"
"0","      theme_bw() +"
"0","  labs(y = ""M in the high freq. band (normalised)"", x = ""Lunar Phase"")+"
"0","  scale_x_continuous(breaks = seq(1, 8, by = 1), "
"0","                     limits = c(1, 8), "
"0","                     expand = expansion(add = 0),"
"0","                     labels = c(""New"", """", ""Waxing"", """", ""Full"", """", ""Waning"", """")) +"
"0","  scale_y_continuous(expand = expansion(add=0), limits = c(-0.51, 0.51))+"
"0","  custom_theme"
"0",""
"0","# plotting temp"
"0","p_temp_HFM <- sm |>"
"0","  filter(.smooth == ""s(stemp)"") |>"
"0","  ggplot() +"
"0","  geom_ribbon(aes(ymin = .lower_ci, ymax = .upper_ci, x = stemp), "
"0","    fill = my_cols[2], alpha = 0.2) +"
"0","  geom_line(aes(x = stemp, y = .estimate), colour = my_cols[2], lwd = 1) +  "
"0","  theme_bw() +"
"0","  labs(y = ""M in the high freq. band (normalised)"", x = ""Normalised Sea Temperature (Deg C)"")+"
"0","  scale_x_continuous(expand = expansion(add=0))+"
"0","  scale_y_continuous(expand = expansion(add=0), limits = c(-1.5, 1.5))+"
"0","  custom_theme"
"0",""
"0","# combine low and high freq plots"
"0","combo_plot <- ggarrange(p_time_LFM, p_time_HFM, "
"0","                        p_lunar_LFM, p_lunar_HFM,"
"0","                        p_current_LFM, p_temp_HFM, "
"0","                           #labels = c(""A"", ""B"", ""C""),"
"0","                           #hjust = -46, "
"0","                           ncol = 2, nrow = 3,"
"0","                           heights = c(1, 1, 1),"
"0","                           font.label = list(size = 7))"
"0",""
"0","ggsave(""../Plots/combo_plot_all_freqs.png"", combo_plot,  width = 20, height = 12, units = ""cm"")"
"0",""
